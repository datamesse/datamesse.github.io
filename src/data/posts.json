[{"id":1632578400,"title":"Power BI Find date for the nth specific day of a month\r","date":"September 26, 2021\r","content":"\r\nUsing Power Query to find the 1st, 2nd, 3rd or 4th specific day of a month/year (e.g. date of 3rd Tuesday), based on another date column.\r\n\r\nIn Power BI this can be used for the conditional logic of other Custom Columns. For example, to create indicators that data rows occur on or fall between relative date ranges e.g. Black Friday sales. The following involves adding a Custom Column in Power Query i.e. M code, not DAX.\r\n\r\nFinds the 1st Monday of the month, where our dependent date column is OurDateField.\r\n\r\n```\r\nDate.FromText(Text.From(Date.Year([OurDateField])) & \"/10/\" & Text.From((7 - (Date.DayOfWeek(Date.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\"),Day.Monday)))))\r\n```\r\n\r\n![Power Query: 1st Sunday of month](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/1.png?raw=true)\r\n\r\n**How it works**\r\n\r\nTo find the first Sunday of a specific month/year relative to another date, first establish the start of the month e.g. 1/10 (1st October), passing in the date field you are using e.g. [OurDateField], to append its year.\r\n\r\n```\r\nDate.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\")\r\n```\r\n\r\n In this example, we are hard-coding October regardless of OurDateField’s month value, but if you need it to be relative to its month too, simply add an extra concatenation for month in the same way year is treated, i.e. using Date.Month().\r\n\r\nNow we need to identify what day of the week that this first day of the month is, using Date.DayOfWeek, and setting the optional parameter for what the start of the week is, as Day.Monday\r\n\r\n```\r\nDate.DayOfWeek(Date.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\"),Day.Monday)\r\n```\r\n\r\n![Power Query: Day of week number](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/2.png?raw=true)\r\n\r\n \r\nIn this example, 1st October 2021 is a Friday, and Friday’s day number is 4 (with Monday being 0).\r\n\r\n![Calendar: Weekday of 1st day of month](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/3.png?raw=true)\r\n\r\nIf you do not provide the Day.Monday parameter, it will default to Day.Monday in the background. If another parameter is used e.g. Day.Sunday, then the assignment numbers will change.\r\n\r\nNow we subtract the weekday number 4 from 7, and get 3, which is the first Sunday’s date.\r\n\r\n```\r\n7 - (Date.DayOfWeek(Date.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\"),Day.Monday))\r\n```\r\n\r\n![Power Query: Date of 1st Sunday](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/4.png?raw=true)\r\n\r\nThen concatenate this with the year month retrieved earlier\r\n\r\n```\r\nDate.FromText(Text.From(Date.Year([OurDateField])) & \"/10/\" & Text.From((7 - (Date.DayOfWeek(Date.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\"),Day.Monday)))))\r\n```\r\n\r\n![Power Query: Concatenate the month year to the date](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/5.png?raw=true)\r\n\r\nIf you need to change the weekday that Power Query needs to find, simply increment the Day.Monday parameter to the following day of the desired weekday.\r\n\r\nFor example, if you want to find the first Wednesday, change the parameter to Day.Thursday.\r\n\r\n```\r\nDate.FromText(Text.From(Date.Year([OurDateField])) & \"/10/\" & Text.From((7 - (Date.DayOfWeek(Date.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\"),Day.Thursday)))))\r\n```\r\n\r\n![Power Query: 1st Wednesday of month](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/6.png?raw=true)\r\n\r\n![Calendar: 1st Wednesday of the month](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/7.png?raw=true)\r\n\r\nIf you need to change the position from first, to second, third, or fourth Sunday, simply add 7 for the second, 14 for the third, and 21 for the fourth.\r\n\r\nFor example, we will retrieve the 3rd Sunday.\r\n\r\n```\r\nDate.FromText(Text.From(Date.Year([OurDateField])) & \"/10/\" & Text.From((7 - (Date.DayOfWeek(Date.FromText(Text.From(Date.Year([OurDateField])) & \"/10/1\"),Day.Monday)) + 14 )))\r\n```\r\n\r\n![Calendar: 3rd Sunday of the month](https://github.com/datamesse/blog/blob/master/assets/images/blog/2021-01-16-power-bi-find-1st-2nd-3rd-specific-day-of-a-month/8.png?raw=true)"}]